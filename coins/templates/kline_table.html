{% extends "base_generic.html" %}

{% block title%}
<title>Данные Kline (Свечи)</title>
{% endblock %}

{% block content %}
<div class="container mt-5">
    <h1 class="text-center mb-4">Данные Kline (История свечей)</h1>

    <!-- Форма фильтрации -->
    <form method="get" class="mb-4">
        <div class="row g-3">
            <div class="col-md-3">
                <label for="symbol" class="form-label">Название монеты:</label>
                <!-- Используем переменную контекста, переданную из view -->
                <input type="text" name="symbol" id="symbol" class="form-control" placeholder="введите название" value="{{ symbol_filter }}">
            </div>
            
            <div class="col-md-3">
                <label for="min_timestamp" class="form-label">Время ОТ (Timestamp):</label>
                <!-- Используем переменную контекста, переданную из view -->
                <input type="number" name="min_timestamp" id="min_timestamp" class="form-control" placeholder="Мин. Timestamp" value="{{ min_timestamp_filter }}">
            </div>

            <div class="col-md-3">
                <label for="max_timestamp" class="form-label">Время ДО (Timestamp):</label>
                <input type="number" name="max_timestamp" id="max_timestamp" class="form-control" placeholder="Макс. Timestamp" value="{{ max_timestamp_filter }}">
            </div>

            <div class="col-md-3">
                <label for="min_volume" class="form-label">мин обьем:</label>
                <!-- Используем переменную контекста, переданную из view -->
                <input type="number" name="min_volume" id="min_volume" class="form-control" placeholder="Мин. volume" value="{{ min_volume_filter }}">
            </div>

            <div class="col-md-3">
                <label for="max_volume" class="form-label">макс обьем:</label>
                <input type="number" name="max_volume" id="max_volume" class="form-control" placeholder="Макс. volume" value="{{ max_volume_filter }}">
            </div>
            


        </div>
        <div class="mt-3">
            <button type="submit" class="btn btn-primary me-2">Применить фильтр</button>
            <a href="{% url 'kline_table' %}" class="btn btn-secondary">Очистить фильтр</a>
        </div>
    </form>

    <!-- Таблица данных -->
    <table class="table table-striped table-bordered table-hover">
        <thead class="table-dark">
            <tr>
                <th scope="col">Название</th>
                <th scope="col">Timestamp</th>
                <th scope="col">Open Price</th>
                <th scope="col">Close Price</th>
                <th scope="col">High Price</th>
                <th scope="col">Low Price</th>
                <th scope="col">Volume</th>
            </tr>
        </thead>
        <tbody>
            <!-- Меняем 'coins' на 'kline_list' (или 'kline' как вы назвали в return render) -->
            {% for item in kline %}
                <tr>
                    <td>{{ item.symbol }}</td>
                    <td>{{ item.timestamp }}</td>
                    <td>{{ item.open_price|floatformat:2 }}</td>
                    <td>{{ item.close_price|floatformat:2 }}</td>
                    <td>{{ item.high_price|floatformat:2 }}</td>
                    <td>{{ item.low_price|floatformat:2 }}</td>
                    <td>{{ item.volume|floatformat:4 }}</td>
                </tr>
            {% empty %}
                <tr>
                    <td colspan="7" class="text-center">Данные не найдены или не соответствуют фильтрам.</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
